<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å¯†è²¨å¹£æ™ºèƒ½æˆ°æƒ…å®¤ (Pro Ver.)</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", "Segoe UI", Roboto, sans-serif; background-color: #131722; color: #d1d4dc; margin: 0; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        
        /* é ‚éƒ¨ Header */
        .header-section { display: flex; flex-direction: column; align-items: center; margin-bottom: 25px; }
        h1 { color: #F0B90B; margin: 0 0 15px 0; font-weight: 700; letter-spacing: 1px; }
        
        /* å¹£ç¨®åˆ‡æ›æŒ‰éˆ• */
        .coin-switcher { display: flex; gap: 10px; background: #1e222d; padding: 5px; border-radius: 30px; }
        .coin-btn {
            background: transparent; border: none; color: #aaa;
            padding: 8px 25px; border-radius: 20px; cursor: pointer;
            font-size: 1rem; font-weight: bold; transition: 0.3s;
        }
        .coin-btn:hover { color: #fff; background: rgba(255,255,255,0.1); }
        .coin-btn.active { background: #F0B90B; color: #000; box-shadow: 0 2px 10px rgba(240, 185, 11, 0.3); }

        /* ç¶²æ ¼ä½ˆå±€ */
        .grid-top { display: grid; grid-template-columns: 2.5fr 1fr; gap: 20px; margin-bottom: 20px; }
        .grid-mid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 20px; }
        .grid-bottom { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        
        .card { background: #1e222d; border-radius: 8px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.2); border: 1px solid #2a2e39; }
        .chart-box { height: 600px; }
        .gauge-box { height: 600px; }
        .info-box { height: auto; min-height: 280px; display: flex; flex-direction: column; }

        /* æ–æ³¢é‚£å¥‘èˆ‡ AI å»ºè­°æ¨£å¼ */
        .fib-controls { display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid #2a2e39; padding-bottom: 15px; }
        .fib-btn { 
            background: #2a2e39; color: #aaa; border: 1px solid #434651; padding: 6px 15px; 
            border-radius: 4px; cursor: pointer; font-size: 0.9rem; transition: 0.3s; 
        }
        .fib-btn.active { background: #F0B90B; color: #000; border-color: #F0B90B; font-weight: bold; }
        
        .fib-table { width: 100%; border-collapse: collapse; text-align: left; margin-top: 10px; }
        .fib-table th { color: #787b86; font-size: 0.85rem; padding: 8px; border-bottom: 1px solid #2a2e39; }
        .fib-table td { padding: 10px 8px; border-bottom: 1px solid #2a2e39; font-family: 'Roboto Mono', monospace; font-size: 1rem; }
        .row-golden { background: rgba(240, 185, 11, 0.08); }
        .highlight-price { font-weight: bold; color: #fff; }

        /* AI å»ºè­°å€å¡Š */
        .ai-box { margin-top: 20px; background: #262b38; padding: 15px; border-left: 4px solid #F0B90B; border-radius: 4px; }
        .ai-title { font-weight: bold; color: #F0B90B; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .ai-content { font-size: 0.95rem; line-height: 1.6; color: #d1d4dc; }
        .status-green { color: #00c853; font-weight: bold; }
        .status-red { color: #ff5252; font-weight: bold; }
        .status-yellow { color: #ffd600; font-weight: bold; }

        /* æ•¸æ“šé¡¯ç¤º */
        .data-display { font-size: 2rem; font-weight: bold; margin: 10px 0; color: #fff; }
        .data-sub { font-size: 0.9rem; color: #888; margin-bottom: 5px; }
        .fear-box { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; padding: 10px; background: #131722; border-radius: 6px; }

        /* æŒ‰éˆ•é€£çµ */
        .btn-link {
            display: block; width: 100%; text-align: center; background: #2a2e39; color: #F0B90B;
            padding: 10px 0; margin-top: auto; text-decoration: none; border-radius: 4px; font-weight: bold; border: 1px solid #434651; transition: 0.2s;
        }
        .btn-link:hover { background: #F0B90B; color: #000; }

        @media (max-width: 1024px) {
            .grid-top, .grid-bottom { grid-template-columns: 1fr; }
            .chart-box, .gauge-box { height: 500px; }
        }
    </style>
</head>
<body>

<div class="container">
    
    <div class="header-section">
        <h1>åŠ å¯†è²¨å¹£æ™ºèƒ½åˆ†æå„€è¡¨æ¿</h1>
        <div class="coin-switcher">
            <button class="coin-btn active" onclick="switchCoin('BTC')">BTC</button>
            <button class="coin-btn" onclick="switchCoin('BNB')">BNB</button>
            <button class="coin-btn" onclick="switchCoin('ETC')">ETC</button>
        </div>
    </div>

    <div class="grid-top">
        <div class="card chart-box">
            <h3 style="margin-top:0; color:#eee; font-size:1.1rem;">ğŸ“ˆ <span class="coin-name">BTC</span>/USDT æŠ€è¡“èµ°å‹¢åœ–</h3>
            <div id="tv-chart-container" style="height:calc(100% - 30px);width:100%"></div>
        </div>
        
        <div class="card gauge-box">
            <h3 style="margin-top:0; color:#eee; font-size:1.1rem;">âš¡ æŠ€è¡“åˆ†æå»ºè­° (å¤šç©ºåŠ›é“)</h3>
            <div id="tv-gauge-container" style="height:calc(100% - 30px);width:100%"></div>
        </div>
    </div>

    <div class="grid-mid">
        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0; color:#eee;">ğŸ“ æ–æ³¢é‚£å¥‘å›æ¸¬æ™ºèƒ½è¨ˆç®— (Fibonacci Retracement)</h3>
                <span id="loading-text" style="display:none; color:#F0B90B; font-size:0.9rem;">æ•¸æ“šé‹ç®—ä¸­...</span>
            </div>
            <p style="color:#777; font-size:0.9rem; margin-bottom:15px;">ç³»çµ±è‡ªå‹•æŠ“å– Binance æ­·å²æ•¸æ“šï¼Œè¨ˆç®—è©²å€é–“çš„æœ€é«˜åƒ¹(100%)èˆ‡æœ€ä½åƒ¹(0%)ï¼Œä¸¦æ¨ç®—å‡ºé—œéµæ”¯æ’å›èª¿ä½ã€‚</p>
            
            <div class="fib-controls">
                <button class="fib-btn active" onclick="calculateFib(30, this)">è¿‘ 1 å€‹æœˆ</button>
                <button class="fib-btn" onclick="calculateFib(90, this)">è¿‘ 3 å€‹æœˆ</button>
                <button class="fib-btn" onclick="calculateFib(180, this)">è¿‘ 6 å€‹æœˆ</button>
                <button class="fib-btn" onclick="calculateFib(365, this)">è¿‘ 1 å¹´</button>
            </div>

            <table class="fib-table">
                <thead>
                    <tr>
                        <th width="20%">å›æ’¤æ¯”ä¾‹</th>
                        <th width="25%">é—œéµåƒ¹ä½ (USDT)</th>
                        <th width="30%">æŠ€è¡“æ„ç¾©</th>
                        <th width="25%">ç›®å‰è·é›¢</th>
                    </tr>
                </thead>
                <tbody id="fib-body"></tbody>
            </table>

            <div class="ai-box">
                <div class="ai-title">ğŸ¤– AI æ™ºèƒ½æ“ä½œå»ºè­° (<span class="coin-name">BTC</span>)</div>
                <div id="ai-advice-content" class="ai-content">
                    æ­£åœ¨åˆ†æå¸‚å ´æ•¸æ“šèˆ‡æŠ€è¡“æŒ‡æ¨™...
                </div>
            </div>
        </div>
    </div>

    <div class="grid-bottom">
        
        <div class="card info-box">
            <h3 style="margin-top:0;">ğŸ˜± ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸ (Crypto)</h3>
            <div style="flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
                <div style="text-align:center;">
                    <div id="fng-value" class="data-display">Loading...</div>
                    <div id="fng-status" style="font-size:1.2rem; font-weight:bold; margin-bottom:15px;">---</div>
                </div>
                
                <div class="fear-box">
                    <span class="data-sub">æ˜¨æ—¥æŒ‡æ•¸</span>
                    <span id="fng-yesterday" style="font-weight:bold; color:#fff;">--</span>
                </div>
                <div class="fear-box">
                    <span class="data-sub">æ›´æ–°æ™‚é–“</span>
                    <span id="fng-update" style="font-size:0.8rem;">--</span>
                </div>
            </div>
            <p style="font-size:0.8rem; color:#666; margin-top:10px;">* < 25 æ¥µåº¦ææ‡¼ (è²·é») | > 75 æ¥µåº¦è²ªå©ª (è³£é»)</p>
        </div>

        <div class="card info-box" id="ahr-card">
            <h3 style="margin-top:0;">ğŸ’ Ahr999 å›¤å¹£æŒ‡æ¨™ (BTCå°ˆç”¨)</h3>
            <div style="flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
                <div class="data-sub">ç›®å‰ BTC åƒ¹æ ¼</div>
                <div id="btc-current-price" class="data-display" style="color:#F0B90B;">$---</div>
                
                <div style="background:#131722; padding:10px; border-radius:6px; margin-top:10px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                        <span style="color:#00c853; font-size:0.9rem;">æŠ„åº•å€é–“ (&lt;0.45)</span>
                        <span style="font-size:0.9rem; color:#aaa;">è«‹åƒè€ƒ Coinglass</span>
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <span style="color:#ff5252; font-size:0.9rem;">èµ·é£›å€é–“ (&gt;1.20)</span>
                        <span style="font-size:0.9rem; color:#aaa;">æš«åœå®šæŠ•</span>
                    </div>
                </div>
                <p style="font-size:0.85rem; color:#aaa; margin-top:10px;">
                    è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•æŸ¥çœ‹æœ€æ–°çš„ã€ŒæŠ„åº•ç·šã€èˆ‡ã€Œå®šæŠ•ç·šã€å…·é«”åƒ¹æ ¼ã€‚
                </p>
            </div>
            <a href="https://www.coinglass.com/zh-TW/pro/i/ahr999" target="_blank" class="btn-link">æŸ¥çœ‹ Ahr999 å³æ™‚åœ–è¡¨</a>
        </div>

        <div class="card info-box" id="alt-card" style="display:none; justify-content:center; align-items:center;">
            <p style="color:#666;">Ahr999 æŒ‡æ¨™åƒ…é©ç”¨æ–¼ Bitcoin</p>
        </div>

        <div class="card info-box">
            <h3 style="margin-top:0;">ğŸ“ ç­–ç•¥é‚è¼¯èªªæ˜</h3>
            <ul style="padding-left: 20px; line-height: 1.8; color: #ccc; font-size: 0.95rem;">
                <li><strong>å¼·æ”¯æ’ä½ï¼š</strong>åƒè€ƒ 0.618 (é»ƒé‡‘å›èª¿ä½)ï¼Œè‹¥å›èª¿ä¸ç ´ï¼Œç‚ºå‹ç‡è¼ƒé«˜è²·é»ã€‚</li>
                <li><strong>åˆ†æ‰¹æ­¢ç›ˆï¼š</strong>ç•¶ RSI > 70 (éç†±) ä¸”åƒ¹æ ¼æ¥è¿‘ 100% å‰é«˜å£“åŠ›æ™‚ï¼Œå»ºè­°æ¸›å€‰ã€‚</li>
                <li><strong>è¶¨å‹¢åˆ¤æ–·ï¼š</strong>0.5 ç‚ºå¤šç©ºåˆ†ç•Œï¼Œè·Œç ´ 0.5 é€šå¸¸è¦–ç‚ºè¶¨å‹¢è½‰å¼±ã€‚</li>
            </ul>
        </div>
    </div>
</div>

<script>
    let currentCoin = 'BTC';
    let currentSymbol = 'BTCUSDT';

    // åˆå§‹åŒ–
    window.onload = function() {
        switchCoin('BTC');
        fetchFearAndGreed();
    };

    // åˆ‡æ›å¹£ç¨®
    function switchCoin(coin) {
        currentCoin = coin;
        currentSymbol = coin + 'USDT';
        
        // æ›´æ–° UI åç¨±
        document.querySelectorAll('.coin-name').forEach(el => el.innerText = coin);
        
        // æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.coin-btn').forEach(btn => {
            btn.classList.toggle('active', btn.innerText === coin);
        });

        // Ahr999 é¡¯ç¤ºæ§åˆ¶
        if (coin === 'BTC') {
            document.getElementById('ahr-card').style.display = 'flex';
            document.getElementById('alt-card').style.display = 'none';
        } else {
            document.getElementById('ahr-card').style.display = 'none';
            document.getElementById('alt-card').style.display = 'flex';
        }

        // é‡æ–°è¼‰å…¥åœ–è¡¨
        reloadWidgets(currentSymbol);
        
        // é‡æ–°è¨ˆç®—æ•¸æ“š (é è¨­30å¤©)
        document.querySelectorAll('.fib-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.fib-btn')[0].classList.add('active');
        calculateFib(30);
    }

    // è¼‰å…¥ TradingView Widgets
    function reloadWidgets(symbol) {
        // Kç·šåœ–
        document.getElementById('tv-chart-container').innerHTML = '';
        const scriptChart = document.createElement('script');
        scriptChart.src = 'https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js';
        scriptChart.async = true;
        scriptChart.innerHTML = JSON.stringify({
            "autosize": true, "symbol": "BINANCE:" + symbol, "interval": "D", "timezone": "Asia/Taipei", "theme": "dark", "style": "1", "locale": "zh_TW", "enable_publishing": false, "withdateranges": true, "hide_side_toolbar": false,
            "studies": ["MACD@tv-basicstudies","RSI@tv-basicstudies","StochasticRSI@tv-basicstudies","Volume@tv-basicstudies"],
            "support_host": "https://www.tradingview.com"
        });
        document.getElementById('tv-chart-container').appendChild(scriptChart);

        // å„€è¡¨æ¿ (é–‹å•Ÿæ™‚é–“é¸æ“‡ showIntervalTabs: true)
        document.getElementById('tv-gauge-container').innerHTML = '';
        const scriptGauge = document.createElement('script');
        scriptGauge.src = 'https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js';
        scriptGauge.async = true;
        scriptGauge.innerHTML = JSON.stringify({
            "interval": "1D", "width": "100%", "height": "100%", "isTransparent": true, "symbol": "BINANCE:" + symbol, "showIntervalTabs": true, "displayMode": "single", "locale": "zh_TW", "colorTheme": "dark"
        });
        document.getElementById('tv-gauge-container').appendChild(scriptGauge);
    }

    // æŠ“å–ææ‡¼èˆ‡è²ªå©ªæŒ‡æ•¸
    async function fetchFearAndGreed() {
        try {
            const res = await fetch('https://api.alternative.me/fng/?limit=2');
            const data = await res.json();
            const today = data.data[0];
            const yesterday = data.data[1];

            // ä»Šæ—¥
            document.getElementById('fng-value').innerText = today.value;
            document.getElementById('fng-status').innerText = translateFng(today.value_classification);
            
            // é¡è‰²
            const val = parseInt(today.value);
            const color = val < 25 ? '#ff5252' : (val > 75 ? '#00c853' : '#F0B90B'); // ææ‡¼ç´…(æ©Ÿæœƒ)ï¼Œè²ªå©ªç¶ (å±éšª)ï¼Ÿé€šå¸¸ç¿’æ…£åéä¾†ï¼Œé€™è£¡ä¾æ…£ä¾‹ ææ‡¼=ä½åˆ† è²ªå©ª=é«˜åˆ†
            // ä¿®æ­£é¡è‰²é‚è¼¯ï¼šæ¥µåº¦ææ‡¼(ä½åˆ†)=ç´…è‰², æ¥µåº¦è²ªå©ª(é«˜åˆ†)=ç¶ è‰² (AlternativeåŸç”Ÿè‰²)
            // ä½†ä½¿ç”¨è€…ç­–ç•¥æ˜¯ï¼šææ‡¼=è²·(å¥½äº‹)ï¼Œè²ªå©ª=è³£(å£äº‹)ã€‚ä¸éé€™è£¡ç¶­æŒåŸç”Ÿé¡è‰²è¼ƒç›´è§€ã€‚
            document.getElementById('fng-value').style.color = (val > 50) ? '#00c853' : '#ff5252';

            // æ˜¨æ—¥
            document.getElementById('fng-yesterday').innerText = `${yesterday.value} (${translateFng(yesterday.value_classification)})`;
            
            // æ™‚é–“
            const date = new Date(today.timestamp * 1000);
            document.getElementById('fng-update').innerText = date.toLocaleDateString('zh-TW');

        } catch (e) {
            console.error(e);
            document.getElementById('fng-status').innerText = "æ•¸æ“šè®€å–å¤±æ•—";
        }
    }

    function translateFng(text) {
        if(text.includes('Extreme Fear')) return 'æ¥µåº¦ææ‡¼';
        if(text.includes('Fear')) return 'ææ‡¼';
        if(text.includes('Extreme Greed')) return 'æ¥µåº¦è²ªå©ª';
        if(text.includes('Greed')) return 'è²ªå©ª';
        return 'ä¸­ç«‹';
    }

    // RSI è¨ˆç®—
    function calculateRSI(closes, period = 14) {
        if (closes.length < period + 1) return 50;
        let gains = 0, losses = 0;
        for (let i = closes.length - period - 1; i < closes.length - 1; i++) {
            const change = closes[i+1] - closes[i];
            if (change > 0) gains += change;
            else losses -= change;
        }
        let avgGain = gains / period;
        let avgLoss = losses / period;
        const rs = avgGain / avgLoss;
        return 100 - (100 / (1 + rs));
    }

    // æ–æ³¢é‚£å¥‘èˆ‡ AI åˆ†ææ ¸å¿ƒ
    async function calculateFib(days, btnElement) {
        if(btnElement) {
            document.querySelectorAll('.fib-btn').forEach(b => b.classList.remove('active'));
            btnElement.classList.add('active');
        }
        document.getElementById('loading-text').style.display = 'inline';

        try {
            // æŠ“æ•¸æ“š
            const limit = days + 20;
            const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=${currentSymbol}&interval=1d&limit=${limit}`);
            const data = await res.json();

            let maxPrice = -Infinity, minPrice = Infinity;
            const closes = [];
            const analysisData = data.slice(data.length - days);

            analysisData.forEach(k => {
                const h = parseFloat(k[2]), l = parseFloat(k[3]), c = parseFloat(k[4]);
                if(h > maxPrice) maxPrice = h;
                if(l < minPrice) minPrice = l;
                closes.push(c);
            });

            const currentPrice = parseFloat(data[data.length - 1][4]);
            
            // æ›´æ–° BTC åƒ¹æ ¼é¡¯ç¤º (for Ahr999)
            if(currentCoin === 'BTC') {
                document.getElementById('btc-current-price').innerText = `$${currentPrice.toLocaleString()}`;
            }

            // è¨ˆç®— RSI
            const allCloses = data.map(d => parseFloat(d[4]));
            const rsi = calculateRSI(allCloses);

            // è¨ˆç®—æ–æ³¢é‚£å¥‘ä½
            const diff = maxPrice - minPrice;
            const levels = [
                { r: 1, p: maxPrice, note: "å‰é«˜å£“åŠ› (100%)", class: "status-red" },
                { r: 0.618, p: maxPrice - (diff * 0.618), note: "é»ƒé‡‘å£è¢‹ (å¼·æ”¯æ’)", class: "row-golden status-green" },
                { r: 0.5, p: maxPrice - (diff * 0.5), note: "å¤šç©ºåˆ†ç•Œ (ä¸­è»¸)", class: "highlight-price" },
                { r: 0.382, p: maxPrice - (diff * 0.382), note: "æ”¯æ’ä½ (38.2%)", class: "" },
                { r: 0, p: minPrice, note: "å‰ä½æ”¯æ’ (0%)", class: "status-green" }
            ];

            // æ¸²æŸ“è¡¨æ ¼
            let tableHtml = "";
            levels.forEach(lvl => {
                const dist = ((currentPrice - lvl.p) / lvl.p * 100);
                const distText = (dist > 0 ? '+' : '') + dist.toFixed(2) + '%';
                const colorStyle = (lvl.r === 0.618 || lvl.r === 0.5) ? 'font-weight:bold;' : '';
                
                tableHtml += `
                    <tr class="${lvl.class === 'row-golden status-green' ? 'row-golden' : ''}">
                        <td style="${colorStyle}">${(lvl.r * 100).toFixed(1)}%</td>
                        <td class="highlight-price">$${lvl.p.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                        <td style="${lvl.class ? '' : 'color:#aaa'}">${lvl.note}</td>
                        <td style="color:${dist > 0 ? '#00c853' : '#ff5252'}">${distText}</td>
                    </tr>
                `;
            });
            document.getElementById('fib-body').innerHTML = tableHtml;

            // --- ğŸ¤– AI è‡ªå‹•åˆ¤æ–·åˆ†æ (User Rule Based) ---
            let adviceHtml = "";
            
            // 1. å¼·æ”¯æ’ä½åˆ¤æ–· (0.618)
            const fib618 = levels.find(l => l.r === 0.618).p;
            const dist618 = Math.abs((currentPrice - fib618) / fib618);
            if (currentPrice >= fib618 * 0.98 && currentPrice <= fib618 * 1.02) {
                adviceHtml += `<p>ğŸŸ¢ <strong>å¼·æ”¯æ’ä½å»ºè­°ï¼š</strong> ${currentCoin} ç›®å‰å›èª¿è‡³ 0.618 åƒ¹ä½ ($${fib618.toFixed(2)}) é™„è¿‘ä¸”æœªæœ‰æ•ˆè·Œç ´ï¼Œæ­¤ç‚ºæŠ€è¡“é¢<strong>æœ€ä½³è²·é»</strong>å€åŸŸã€‚</p>`;
            } else if (currentPrice < fib618 * 0.98) {
                adviceHtml += `<p>âš ï¸ <strong>æ”¯æ’è­¦ç¤ºï¼š</strong> ${currentCoin} å·²è·Œç ´ 0.618 æ”¯æ’ä½ ($${fib618.toFixed(2)})ï¼Œéœ€è§€å¯Ÿä¸‹ä¸€æ”¯æ’ 0.5 æˆ–å‰ä½ã€‚</p>`;
            } else {
                adviceHtml += `<p>âšª <strong>æ”¯æ’ç›£æ§ï¼š</strong> ${currentCoin} è·é›¢ 0.618 é»ƒé‡‘æ”¯æ’ä½ ($${fib618.toFixed(2)}) å°šæœ‰ç©ºé–“ï¼Œç­‰å¾…å›èª¿æ©Ÿæœƒã€‚</p>`;
            }

            // 2. åˆ†æ‰¹æ­¢ç›ˆåˆ¤æ–· (RSI > 70 + æ¥è¿‘å‰é«˜)
            const highPrice = maxPrice;
            const distHigh = Math.abs((highPrice - currentPrice) / highPrice);
            if (rsi > 70 && distHigh < 0.05) {
                adviceHtml += `<p>ğŸ”´ <strong>åˆ†æ‰¹æ­¢ç›ˆå»ºè­°ï¼š</strong> ç›£æ¸¬åˆ° RSI (${rsi.toFixed(1)}) éç†±ï¼Œä¸” ${currentCoin} åƒ¹æ ¼æ¥è¿‘ä¸Šæ–¹ 100% å‰é«˜ ($${highPrice.toFixed(2)})ï¼Œå»ºè­°é©åº¦æ¸›å€‰é–å®šåˆ©æ½¤ã€‚</p>`;
            } else if (rsi > 70) {
                 adviceHtml += `<p>âš ï¸ <strong>éç†±è­¦ç¤ºï¼š</strong> RSI æ•¸å€¼ (${rsi.toFixed(1)}) å·²é”è¶…è²·å€ï¼Œè«‹æ³¨æ„çŸ­æœŸå›èª¿é¢¨éšªã€‚</p>`;
            }

            // 3. è¶¨å‹¢åˆ¤æ–· (0.5 ä¸­è»¸)
            const pivot = levels.find(l => l.r === 0.5).p;
            if (currentPrice < pivot) {
                adviceHtml += `<p>ğŸ“‰ <strong>è¶¨å‹¢åˆ¤æ–·ï¼š</strong> ${currentCoin} å·²è·Œç ´ 0.5 ä¸­è»¸ç·š ($${pivot.toFixed(2)})ï¼Œé¡¯ç¤ºçŸ­æœŸç©ºæ–¹åŠ›é“å¢å¼·ï¼Œè¶¨å‹¢å¯èƒ½è½‰å¼±ã€‚</p>`;
            } else {
                adviceHtml += `<p>ğŸ“ˆ <strong>è¶¨å‹¢åˆ¤æ–·ï¼š</strong> ${currentCoin} ç¶­æŒåœ¨ 0.5 ä¸­è»¸ç·š ($${pivot.toFixed(2)}) ä¹‹ä¸Šï¼Œå¤šé ­çµæ§‹ç›®å‰å¥åº·ã€‚</p>`;
            }

            document.getElementById('ai-advice-content').innerHTML = adviceHtml;

        } catch (e) {
            console.error(e);
            document.getElementById('ai-advice-content').innerText = "æ•¸æ“šåˆ†æå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šã€‚";
        } finally {
            document.getElementById('loading-text').style.display = 'none';
        }
    }
</script>

</body>
</html>
